(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-97519f2e"],{c977:function(e,t,o){"use strict";var c=o("4360");t["a"]=()=>{let e;const t=(t=0)=>{e=setTimeout(()=>{c["a"].commit({type:"setLightState",key:"isLoading",value:!0})},t)},o=()=>{clearTimeout(e),c["a"].commit({type:"setLightState",key:"isLoading",value:!1})};return{showLoading:t,hideLoading:o}}},dc10:function(e,t,o){"use strict";o.r(t);var c=o("7a23");const n={class:"m-main m-home"};function a(e,t,o,a,l,s){const r=Object(c["resolveComponent"])("Sidebar"),i=Object(c["resolveComponent"])("List");return Object(c["openBlock"])(),Object(c["createBlock"])("div",n,[Object(c["createVNode"])(r),Object(c["createVNode"])(i)])}var l=o("5502");const s={class:"m-sidebar"};function r(e,t,o,n,a,l){const r=Object(c["resolveComponent"])("SidebarItem");return Object(c["openBlock"])(),Object(c["createBlock"])("div",s,[(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(n.list,e=>(Object(c["openBlock"])(),Object(c["createBlock"])(r,{key:e.id,sidebarItem:e},null,8,["sidebarItem"]))),128))])}function i(e,t,o,n,a,l){return Object(c["openBlock"])(),Object(c["createBlock"])("div",{class:"m-sidebar-item "+(n.currentId===o.sidebarItem.id?"active":""),onClick:t[1]||(t[1]=e=>n.handleNav(o.sidebarItem.id))},Object(c["toDisplayString"])(o.sidebarItem.title),3)}var d={props:{sidebarItem:{type:Object}},setup(){const e=Object(l["b"])(),t=Object(c["computed"])(()=>e.state.light.currentId),o=t=>{let o=document.getElementById(t);o.scrollIntoView({block:"start",behavior:"smooth"}),e.commit({type:"setLightState",key:"currentId",value:t}),e.commit({type:"setLightState",key:"isRealScroll",value:!1})};return{currentId:t,handleNav:o}}};d.render=i;var b=d,u={components:{SidebarItem:b},setup(){const e=Object(l["b"])(),t=Object(c["computed"])(()=>e.state.light.list);return{list:t}}};u.render=r;var m=u;const p={class:"m-add-wrap"},O={class:"m-add"};function k(e,t,o,n,a,l){const s=Object(c["resolveComponent"])("Category"),r=Object(c["resolveComponent"])("Dialog");return Object(c["openBlock"])(),Object(c["createBlock"])("div",{class:"m-list",onScroll:t[4]||(t[4]=(...e)=>n.handleScroll&&n.handleScroll(...e))},[(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(n.list,e=>(Object(c["openBlock"])(),Object(c["createBlock"])(s,{key:e.id,category:e,onOnTopArr:n.handleTopArr},null,8,["category","onOnTopArr"]))),128)),(Object(c["openBlock"])(),Object(c["createBlock"])(c["Teleport"],{to:"body"},[Object(c["createVNode"])(r,{visible:n.isListDialogVisible,title:"添加",onOnClose:n.handleClose,onOnOk:n.handleOk},{content:Object(c["withCtx"])(()=>[Object(c["createVNode"])("div",p,[Object(c["createVNode"])("div",O,[Object(c["createVNode"])("button",{class:"m-btn",onClick:t[1]||(t[1]=(...e)=>n.handleSubCount&&n.handleSubCount(...e))},"-"),Object(c["createVNode"])("input",{type:"text",class:"m-add-input",value:n.addBook.count,onInput:t[2]||(t[2]=(...e)=>n.handleInputCount&&n.handleInputCount(...e))},null,40,["value"]),Object(c["createVNode"])("button",{class:"m-btn",onClick:t[3]||(t[3]=(...e)=>n.handleAddCount&&n.handleAddCount(...e))},"+")])])]),_:1},8,["visible","onOnClose","onOnOk"])]))],32)}const j={class:"m-category-title"};function h(e,t,o,n,a,l){const s=Object(c["resolveComponent"])("CategoryItem");return Object(c["openBlock"])(),Object(c["createBlock"])("div",{id:o.category.id,class:"js-category"},[Object(c["createVNode"])("div",j,Object(c["toDisplayString"])(o.category.title),1),(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(o.category.list,e=>(Object(c["openBlock"])(),Object(c["createBlock"])(s,{key:e.id,book:e},null,8,["book"]))),128))],8,["id"])}const g={class:"m-category-item"},v=Object(c["createVNode"])("div",{class:"m-category-item-img-loading"},null,-1),y={class:"m-category-item-info"},C={class:"m-book-price"};function B(e,t,o,n,a,l){const s=Object(c["resolveComponent"])("el-image"),r=Object(c["resolveComponent"])("Stars");return Object(c["openBlock"])(),Object(c["createBlock"])("div",g,[Object(c["createVNode"])(s,{alt:o.book.title,src:o.book.avatar,lazy:"",class:"m-category-item-img",onClick:t[1]||(t[1]=e=>n.handleImageClick(o.book.id))},{placeholder:Object(c["withCtx"])(()=>[v]),_:1},8,["alt","src"]),Object(c["createVNode"])("div",y,[Object(c["createVNode"])("div",null,Object(c["toDisplayString"])(o.book.title),1),Object(c["createVNode"])(r,{number:o.book.stars},null,8,["number"]),Object(c["createVNode"])("div",C,"￥"+Object(c["toDisplayString"])(o.book.price),1),Object(c["createVNode"])("button",{onClick:t[2]||(t[2]=(...e)=>n.handleShowDialog&&n.handleShowDialog(...e))},"添加")])])}function S(e,t,o,n,a,l){const s=Object(c["resolveComponent"])("Icon");return Object(c["openBlock"])(),Object(c["createBlock"])("div",null,[(Object(c["openBlock"])(),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(5,e=>Object(c["createVNode"])(s,{key:e,name:"star",className:"m-star "+(e<=o.number?"active":"")},null,8,["className"])),64))])}var L=o("ec63"),N={props:{number:{type:Number,default:0}},components:{Icon:L["a"]}};N.render=S;var I=N,V=o("6c02"),f={props:{book:{type:Object}},components:{Stars:I},setup(e){const t=Object(l["b"])(),o=Object(V["d"])(),c=()=>{t.commit({type:"setLightState",key:"isListDialogVisible",value:!0});const o=e.book;o.count=1,t.commit({type:"setLightState",key:"addBook",value:o})},n=e=>{o.push("/light/detail/"+e)};return{handleShowDialog:c,handleImageClick:n}}};f.render=B;var w=f,D={props:{category:{type:Object}},components:{CategoryItem:w},emits:["onTopArr"],setup(e,{emit:t}){Object(c["onMounted"])(()=>{const e=[...document.getElementsByClassName("js-category")].map(e=>e.offsetTop);e.push(1/0),t("onTopArr",e)})}};D.render=h;var T=D;let A,x=[];var F=()=>{const e=Object(l["b"])(),t=t=>{if(e.state.light.isRealScroll){let{scrollTop:o}=t.target;o+=x[0];const c=x.findIndex((e,t,c)=>e<=o&&o<c[t+1]);c!==e.state.light.currentId&&e.commit({type:"setLightState",key:"currentId",value:c})}else clearTimeout(A),A=setTimeout(()=>{e.commit({type:"setLightState",key:"isRealScroll",value:!0})},300)},o=e=>{x=e};return{handleScroll:t,handleTopArr:o}},M=o("c977"),R=()=>{const e=Object(l["b"])(),t=()=>{e.commit({type:"setLightState",key:"isListDialogVisible",value:!1})},o=async()=>{const o=e.state.light.addBook,{showLoading:c,hideLoading:n}=Object(M["a"])();""!==o.count&&(c(),e.dispatch({type:"addMyBooks",book:o}).then(()=>{t(),n()}))},c=()=>{const t=e.state.light.addBook;t.count++,e.commit({type:"setLightState",key:"addBook",value:t})},n=()=>{const t=e.state.light.addBook;t.count>1&&(t.count--,e.commit({type:"setLightState",key:"addBook",value:t}))},a=t=>{const o=e.state.light.addBook;o.count=t.target.value.replace(/[^\d]/g,""),""!==o.count&&(o.count=parseInt(o.count)),e.commit({type:"setLightState",key:"addBook",value:{...o}})};return{handleClose:t,handleOk:o,handleAddCount:c,handleSubCount:n,handleInputCount:a}};const $={class:"m-dialog"},E={class:"m-dialog-header"},J={class:"m-dialog-header-title"},_={class:"m-dialog-content"},z={class:"m-dialog-footer"};function X(e,t,o,n,a,l){return Object(c["openBlock"])(),Object(c["createBlock"])("div",{class:["m-mask "+(o.visible?"active":"")]},[Object(c["createVNode"])("div",$,[Object(c["createVNode"])("div",E,[Object(c["createVNode"])("span",J,Object(c["toDisplayString"])(o.title),1),Object(c["createVNode"])("span",{class:"m-dialog-header-close",onClick:t[1]||(t[1]=(...e)=>n.handleClose&&n.handleClose(...e))},"X")]),Object(c["createVNode"])("div",_,[Object(c["renderSlot"])(e.$slots,"content")]),Object(c["createVNode"])("div",z,[Object(c["createVNode"])("button",{class:"m-btn",onClick:t[2]||(t[2]=(...e)=>n.handleClose&&n.handleClose(...e))},"取消"),Object(c["createVNode"])("button",{class:"m-btn",onClick:t[3]||(t[3]=(...e)=>n.handleOk&&n.handleOk(...e))},"确定")])])],2)}var q={props:{visible:{type:Boolean},title:{type:String}},emits:["onClose","onOk"],setup(e,{emit:t}){const o=()=>{t("onClose")},c=()=>{t("onOk")};return{handleClose:o,handleOk:c}}};q.render=X;var G=q,H={components:{Category:T,Dialog:G},setup(){const e=Object(l["b"])(),t=Object(c["computed"])(()=>e.state.light.list),o=Object(c["computed"])(()=>e.state.light.currentId),n=Object(c["computed"])(()=>e.state.light.addBook),a=Object(c["computed"])(()=>e.state.light.isListDialogVisible),{handleScroll:s,handleTopArr:r}=F(),{handleClose:i,handleOk:d,handleAddCount:b,handleSubCount:u,handleInputCount:m}=R();return{list:t,currentId:o,isListDialogVisible:a,handleScroll:s,handleTopArr:r,handleClose:i,handleOk:d,addBook:n,handleAddCount:b,handleSubCount:u,handleInputCount:m}}};H.render=k;var K=H,P={components:{Sidebar:m,List:K},setup(){const e=Object(l["b"])(),{showLoading:t,hideLoading:o}=Object(M["a"])();Object(c["onMounted"])(()=>{t(),e.dispatch({type:"getLightList"}).then(()=>{o()})})}};P.render=a;t["default"]=P},ec63:function(e,t,o){"use strict";var c=o("7a23");function n(e,t,o,n,a,l){return Object(c["openBlock"])(),Object(c["createBlock"])("span",{class:`icon iconfont icon-${o.name} ${o.className}`,onClick:t[1]||(t[1]=(...e)=>n.handleClick&&n.handleClick(...e))},null,2)}var a={props:{name:{type:String,default:""},className:{type:String,default:""}},emits:["onClick"],setup(e,{emit:t}){const o=()=>{t("onClick")};return{handleClick:o}}};a.render=n;t["a"]=a}}]);
//# sourceMappingURL=chunk-97519f2e.378c40df.js.map